---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  fig.align = "center"
)
```

```{r load, include = FALSE}
spatial_limit <- sf::st_read(system.file("extdata/spatial_limit.gpkg",
                                              package = "shoredate",
                                              mustWork = TRUE), quiet = TRUE)
```

# shoredate

<!-- badges: start -->
[![R-CMD-check](https://github.com/isakro/shoredate/actions/workflows/R-CMD-check.yaml/badge.svg)](https://github.com/isakro/shoredate/actions/workflows/R-CMD-check.yaml)
[![Codecov test coverage](https://codecov.io/gh/isakro/shoredate/branch/master/graph/badge.svg)](https://app.codecov.io/gh/isakro/shoredate?branch=master)
<!-- badges: end -->

The goal of *shoredate* is to offer methods to shoreline date Stone Age sites located along the Norwegian Skagerrak coast based on their present-day elevation and the trajectory of relative sea-level change.

## Installation

You can install the development version of *shoredate* from [GitHub](https://github.com/isakro/shoredate) with:

```{r setup, eval = FALSE}
# install.packages("devtools")
devtools::install_github("isakro/shoredate")
```

## Geographical constraint

As the method for shoreline dating is contingent on relative sea-level change it is dependent on local geological conditions and reconstructions of this development. At present, the method as outlined here is limited to being applicable in the region between Horten in the north east to Arendal in the south west, which also formed the study area for Roalkvam (2022). 

```{r, echo = FALSE}

limit_reproj <- sf::st_transform(spatial_limit, crs = 4326)
limit_bbox <- as.numeric(sf::st_bbox(limit_reproj))

plt1 <- ggmap::ggmap(ggmap::get_stamenmap(bbox = c(left = 2, bottom = 54,
                               right = 32, top = 72), zoom = 5,
                maptype = 'terrain-background', source = 'stamen')) +
  ggplot2::geom_rect(
    xmin = limit_bbox[1],
    ymin = limit_bbox[2],
    xmax = limit_bbox[3],
    ymax = limit_bbox[4],
    fill = NA, 
    colour = "black",
    linewidth = 0.6
  )

plt2 <- ggmap::ggmap(ggmap::get_stamenmap(bbox = 
                                            c(left = limit_bbox[1],
                                              bottom = limit_bbox[2],
                                              right = limit_bbox[3],
                                              top = limit_bbox[4]), zoom = 8,
                      maptype = 'terrain', source = 'stamen'))

patchwork::wrap_elements(plt1 + plt2)
```

## Example

This is a basic example outlining how to date a single site by manually specifying the site elevation, and using the default setting for the dating procedure as well as for plotting the date.

```{r date, warning = FALSE, message = FALSE, fig.width = 4, fig.height = 4}
library(shoredate)

# Create example point using the required coordinate system WGS84 UTM32N (EPSG: 32632).
target_point <- sf::st_sfc(sf::st_point(c(579570, 6582982)), crs = 32632)

target_date <- shoreline_date(site = target_point, elevation = 70)

shoredate_plot(target_date)
```

It is also possible to plot a more sparse version  by specifying what elements are to be excluded:

```{r sparse}
shoredate_plot(target_date, elevation_distribution = FALSE, 
               displacement_curve = FALSE, hdr_label = FALSE)
```
